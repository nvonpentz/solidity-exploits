var IntUnderflow = artifacts.require("./IntUnderflow.sol");

contract('IntUnderflow', function(accounts) {
	it ("should be vulnerable to int underflow attacks", function() {
		return IntUnderflow.deployed().then(function(instance) {
			UnderflowInstance = instance;
			// reputation is initialized at 0, to get higher score just downvote once!
			return UnderflowInstance.downvote();
		}).then(function() {
			return UnderflowInstance.getReputation();
		}).then(function(reputation) {
			// after downvote, reputation is maxes out
			assert.notEqual(reputation, 0, "repuation not equal to zero after downgrade");
			assert.equal(reputation, 4294967295, "reputation underflows to become 2^32-1");
		});
	});
});